<!-- Shared Fulfill Order Modal Component -->
<!-- Usage: include 'orders/_fulfill_modal.html' -->
<!-- For show page: pass order_id variable -->
<!-- For index page: order_id will be set via JavaScript -->

<div class="modal fade" id="fulfillModal" tabindex="-1" aria-labelledby="fulfillModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="fulfillModalLabel">{{ _('Mark Order as Fulfilled') }}</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="{{ _('Close') }}"></button>
            </div>
            <form id="fulfillForm" method="POST" {% if order is defined %}action="{{ url_for('orders.toggle_fulfillment', id=order.id) }}"{% endif %}>
                <!-- Hidden field to control redirect behavior -->
                <input type="hidden" id="redirect_to" name="redirect_to" value="">
                <div class="modal-body">
                    <p>{{ _('How would you like to mark this order as fulfilled?') }}</p>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="radio" name="fulfillment_type" id="fulfillOnly" value="mark_only" checked>
                        <label class="form-check-label" for="fulfillOnly">
                            <strong>{{ _('Mark as fulfilled only') }}</strong>
                            <div class="small text-muted">{{ _('Order will be marked as complete without updating inventory') }}</div>
                        </label>
                    </div>
                    
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="fulfillment_type" id="fulfillAndUpdate" value="update_inventory">
                        <label class="form-check-label" for="fulfillAndUpdate">
                            <strong>{{ _('Mark as fulfilled and update inventory') }}</strong>
                            <div class="small text-muted">{{ _('Mark all pending items as fulfilled and add to inventory') }}</div>
                        </label>
                    </div>
                    
                    <div class="alert alert-info mt-3">
                        <i class="fas fa-info-circle me-2"></i>
                        <small>{% if order is defined %}{{ _('Tip: Use individual item fulfillment below to add specific medications to inventory or handle partial deliveries.') }}{% else %}{{ _('Tip: Use individual item fulfillment on the order details page to add specific medications to inventory or handle partial deliveries.') }}{% endif %}</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" data-bs-dismiss="modal">{{ _('Cancel') }}</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-check me-1"></i>{{ _('Mark as Fulfilled') }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>